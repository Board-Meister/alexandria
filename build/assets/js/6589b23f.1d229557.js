"use strict";(self.webpackChunktest=self.webpackChunktest||[]).push([[690],{5582:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"herald/listeners","title":"Listeners","description":"New event listeners can be registrated by using either listen or register. There is no significant difference except","source":"@site/docs/herald/listeners.md","sourceDirName":"herald","slug":"/herald/listeners","permalink":"/docs/herald/listeners","draft":false,"unlisted":false,"editUrl":"https://github.com/Board-Meister/alexandria/blob/master/docs/herald/listeners.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Installation","permalink":"/docs/herald/installation"},"next":{"title":"Dispatching","permalink":"/docs/herald/dispatching"}}');var r=t(4848),s=t(8453);const o={sidebar_position:3},l="Listeners",a={},d=[{value:"Registration parameters",id:"registration-parameters",level:2},{value:"Registration object",id:"registration-object",level:3},{value:"<code>method</code>*",id:"method",level:3},{value:"<code>priority</code>",id:"priority",level:3},{value:"<code>constraint</code>",id:"constraint",level:3},{value:"<code>anchor</code>",id:"anchor",level:3},{value:"Register multiple events",id:"register-multiple-events",level:2},{value:"How to remove the listener",id:"how-to-remove-the-listener",level:2},{value:"Owned identifier",id:"owned-identifier",level:3},{value:"Generated method",id:"generated-method",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"listeners",children:"Listeners"})}),"\n",(0,r.jsxs)(n.p,{children:["New event listeners can be registrated by using either ",(0,r.jsx)(n.code,{children:"listen"})," or ",(0,r.jsx)(n.code,{children:"register"}),". There is no significant difference except\nusage:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="listen.ts"',children:"herald.listen({\n    event: 'event',\n    subscription: () => {\n        console.log('Event fired!');\n    },\n})\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",metastring:'title="register.ts"',children:"herald.register(\"event\", () => {\n    console.log('Event fired!');\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For some cases it is better to have a function that accepts an object: it's more robust, flexible and easier to\nmaintain. But takes more space when used. As an alternative you can use ",(0,r.jsx)(n.code,{children:"register"})," which will result in smaller size but\nmight be harder to maintain, if, for example, new version introduces another parameter which will change order of\nthe arguments."]}),"\n",(0,r.jsx)(n.h2,{id:"registration-parameters",children:"Registration parameters"}),"\n",(0,r.jsx)(n.p,{children:"Registration accepts quite a few parameters, to make sure you have control over you event."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"event"}),"* - name of the event"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"subscription"}),"* - methods/methods to execute when event fires. You can pass it in few ways:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"string"})," - just the name of the method to execute (like ",(0,r.jsx)(n.code,{children:'"onClick"'}),") which must be combined with ",(0,r.jsx)(n.code,{children:"constraint"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"herald.listen({\n    event: 'event',\n    subscription: 'onClick',\n    constraint: onClickHandlerObject,\n})\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"function"})," - normal function, potentially accepting the event"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"herald.listen({\n    event: 'event',\n    subscription: (e: CustomEvent) => {},\n})\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"object"})," - object defining details of event execution like priority"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"herald.listen({\n    event: 'event',\n    subscription: {\n        method: () => {},\n        priority: 0,\n        constraint: \"boardmeister/router\",\n        anchor: document.createElement('div'),\n    },\n})\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"array"})," - an array of subscription objects"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"herald.listen({\n    event: 'event',\n    subscription: [\n        {\n            method: () => {},\n            priority: 0,\n            constraint: \"boardmeister/router\",\n            anchor: document.createElement('div'),\n        }, {\n            method: () => {},\n        }, {\n            method: () => {},\n            priority: 20,\n            anchor: null,\n        }\n    ],\n})\n"})}),"\n",(0,r.jsx)(n.a,{href:"/docs/herald/listeners#registration-object",children:"Read more on subscription object"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"constraint"})," - name of the ",(0,r.jsx)(n.a,{href:"/docs/marshal/",children:"Marshal"})," plugin or just an object. Used primarily for integration\nwith Marshal."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sort"})," - should events be sorted after registration, defaults to ",(0,r.jsx)(n.code,{children:"true"}),". Pass ",(0,r.jsx)(n.code,{children:"false"})," if you know you will register\n20 new listeners and don't want to waste resources on unnecessary sorting."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"anchor"})," - a Node which is used as an anchor for identifying if to fire this listener on\n",(0,r.jsx)(n.a,{href:"/docs/herald/localized-events",children:"localized events"}),". For each subscription object without anchor, this one will be inserted."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"symbol"})," - each registration has either autogenerated ",(0,r.jsx)(n.code,{children:"Symbol"})," or one given by the method. It is an ID of the\nregistration and is required when removing the event listener."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"registration-object",children:"Registration object"}),"\n",(0,r.jsx)(n.p,{children:"Registration object is probably the most important part of registration as it allows you to set multiple listeners on\nsingle event and decide on their priority among other things."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { OptionalSubscription } from \"@boardmeister/herald\";\n\nconst minimalSubscriptionObject: OptionalSubscription = {\n    method: (e: CustomEvent): Promise<void> => {\n        console.log('Event fired!');\n    },\n}\n\nconst maximalSubscriptionObject: OptionalSubscription = {\n    method: (e: CustomEvent): Promise<void> => {\n        console.log('Event fired!');\n    },\n    priority: 20,\n    constraint: \"boardmeister/plugin\",\n    anchor: document.createElement('div'),\n}\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"method",children:[(0,r.jsx)(n.code,{children:"method"}),"*"]}),"\n",(0,r.jsxs)(n.p,{children:["Method is a required parameter of the object, one that defines the behavior of the listener. It can be either ",(0,r.jsx)(n.code,{children:"string"}),"\nor a ",(0,r.jsx)(n.code,{children:"function"}),", where if ",(0,r.jsx)(n.code,{children:"string"})," was passed you also have to define ",(0,r.jsx)(n.code,{children:"constraint"}),"."]}),"\n",(0,r.jsx)(n.admonition,{title:"Marshal integration",type:"tip",children:(0,r.jsxs)(n.p,{children:["Herald was created as a part of Marshal library, as a was for better communication between plugins. Each time you see a\n",(0,r.jsx)(n.code,{children:"constraint"})," it means it is a part of that integration."]})}),"\n",(0,r.jsx)(n.h3,{id:"priority",children:(0,r.jsx)(n.code,{children:"priority"})}),"\n",(0,r.jsx)(n.p,{children:"One of the core functionalities of this library is ability to set order of your listeners. This is the place to do it.\nIt can be any number - negative, decimal, zero - will be placed properly in the queue. Although events which fire on the\nsame time are sorted by the time of registration - who was quicker will be fired first."}),"\n",(0,r.jsx)(n.h3,{id:"constraint",children:(0,r.jsx)(n.code,{children:"constraint"})}),"\n",(0,r.jsxs)(n.p,{children:["Cen be either ",(0,r.jsx)(n.code,{children:"string"})," or ",(0,r.jsx)(n.code,{children:"object"})," - will be used to execute the listener when ",(0,r.jsx)(n.code,{children:"method"})," was passed as a ",(0,r.jsx)(n.code,{children:"string"}),".\nAs mentioned before this is a part of integration with ",(0,r.jsx)(n.code,{children:"Marshal"})," library to allow registration of event listeners that\ndon't exist of the time of registration."]}),"\n",(0,r.jsx)(n.h3,{id:"anchor",children:(0,r.jsx)(n.code,{children:"anchor"})}),"\n",(0,r.jsxs)(n.p,{children:["Used when preforming ",(0,r.jsx)(n.a,{href:"/docs/herald/localized-events",children:"localized events"}),", accepts any document ",(0,r.jsx)(n.code,{children:"Node"})," which will be used as\na reference of where in the page, this listener is listening. Events fired in specific places in document, are filtered\nbased on the position. If this isn't empty than this event listener will be partaking in the filtration. Overwrites the\n",(0,r.jsx)(n.code,{children:"anchor"})," from the method."]}),"\n",(0,r.jsx)(n.h2,{id:"register-multiple-events",children:"Register multiple events"}),"\n",(0,r.jsxs)(n.p,{children:["For cases when you have multiple events you want to listen to, there is ",(0,r.jsx)(n.code,{children:"batch"})," method."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"herald.batch([\n    {\n        event: 'event',\n        subscription: () => {},\n    },\n    {\n        event: 'event',\n        subscription: () => {},\n        constraint: null,\n        sort: true,\n        symbol: null,\n        anchor: null,\n    },\n])\n"})}),"\n",(0,r.jsxs)(n.p,{children:["It is quite literally an array of ",(0,r.jsx)(n.code,{children:"listen"})," methods. All the parameters work the same so for detailed explanation go\nback to the first paragraph."]}),"\n",(0,r.jsx)(n.h2,{id:"how-to-remove-the-listener",children:"How to remove the listener"}),"\n",(0,r.jsxs)(n.p,{children:["There are two options: either you pass your own identifying ",(0,r.jsx)(n.code,{children:"symbol"})," when registrating and pass it along or use\ngenerated function returned by registration methods (",(0,r.jsx)(n.code,{children:"listen"}),", ",(0,r.jsx)(n.code,{children:"register"})," and ",(0,r.jsx)(n.code,{children:"batch"}),")."]}),"\n",(0,r.jsx)(n.h3,{id:"owned-identifier",children:"Owned identifier"}),"\n",(0,r.jsxs)(n.p,{children:["You can use your own ",(0,r.jsx)(n.code,{children:"symbol"})," to use for registration and removal. To do so you have to pass it during registration and\nuse ",(0,r.jsx)(n.code,{children:"unregister"})," later:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const myIdSymbol = Symbol('event-symbol');\nherald.listen({\n    event: 'my-event',\n    subscription: () => {},\n    symbol: myIdSymbol,\n});\nherald.unregister('my-event', myIdSymbol);\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"Be aware!",type:"danger",children:(0,r.jsxs)(n.p,{children:["Be aware if you register two different listeners with the same symbol for the same event, ",(0,r.jsx)(n.code,{children:"unregister"})," will remove\nboth of them"]})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const myIdSymbol = Symbol('event-symbol');\nherald.listen({\n    event: 'my-event',\n    subscription: () => {\n        console.loh('Event 1!')\n    },\n    symbol: myIdSymbol,\n});\nherald.listen({\n    event: 'my-event',\n    subscription: () => {\n        console.loh('Event 2!')\n    },\n    symbol: myIdSymbol,\n});\nherald.unregister('my-event', myIdSymbol);\n\nawait herald.dispatch(new CustomEvent('my-event')); // No output!\n"})}),"\n",(0,r.jsx)(n.h3,{id:"generated-method",children:"Generated method"}),"\n",(0,r.jsxs)(n.p,{children:["The better idea would be to use special generated functions that registration methods\n(",(0,r.jsx)(n.code,{children:"listen"}),", ",(0,r.jsx)(n.code,{children:"register"})," and ",(0,r.jsx)(n.code,{children:"batch"}),") return:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const unregister = herald.register('my-event', () => {\n    console.log('Second event fired!')\n});\nconst unregisterListen = herald.listen({\n    event: 'my-event',\n    subscription: () => {\n        console.log('Event fired!')\n    },\n});\nconst unregisterBatch = herald.batch([{\n    event: 'my-event',\n    subscription: () => {\n        console.log('Third event fired!')\n    },\n}]);\n// Event fired!\n// Second event fired!\n// Third event fired!\nawait herald.dispatch(new CustomEvent('my-event'));\nunregister();\nunregisterListen();\nunregisterBatch();\n // No output!\nawait herald.dispatch(new CustomEvent('my-event'));\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var i=t(6540);const r={},s=i.createContext(r);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);